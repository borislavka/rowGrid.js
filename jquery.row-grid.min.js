!function(t){function e(e,a,s){for(var i,r,l,n=0,h=[],g=(s=jQuery.makeArray(s||e.querySelectorAll(a.itemSelector))).length,o=e.getBoundingClientRect(),m=Math.floor(o.right-o.left)-parseFloat(t(e).css("padding-left"))-parseFloat(t(e).css("padding-right")),d=[],f=0;f<g;++f)(i=s[f].getElementsByTagName("img")[0])?((r=parseInt(i.getAttribute("width")))||i.setAttribute("width",r=i.offsetWidth),(l=parseInt(i.getAttribute("height")))||i.setAttribute("height",l=i.offsetHeight),d[f]={width:r,height:l}):(s.splice(f,1),--f,--g);g=s.length;for(var c=0;c<g;++c){if(s[c].classList?(s[c].classList.remove(a.firstItemClass),s[c].classList.remove(a.lastItemClass),s[c].classList.remove(a.lastRowClass)):s[c].className=s[c].className.replace(new RegExp("(^|\\b)"+a.firstItemClass+"|"+a.lastItemClass+"|"+a.lastRowClass+"(\\b|$)","gi")," "),n+=d[c].width,h.push(s[c]),c===g-1)for(var p=0;p<h.length;p++){if(0===p){h[p].className+=" "+a.lastRowClass;for(var u=0,w=t(h[p]).prevAll(".gallery-item-first"),x=0;x<w.length;++x)u+=parseInt(t(w[x]).css("height"));var M=u/w.length}var v=c+parseInt(p)-h.length+1,C=M*d[v].width/d[v].height;h[p].style.cssText="width: "+Math.ceil(C)+"px;height: "+Math.ceil(M)+"px;margin-right:"+(p<h.length-1?a.minMargin+"px":0)}if(n+a.maxMargin*(h.length-1)>m){var I=n+a.maxMargin*(h.length-1)-m,y=h.length;if((a.maxMargin-a.minMargin)*(y-1)<I){var A=a.minMargin;I-=(a.maxMargin-a.minMargin)*(y-1)}else{A=a.maxMargin-I/(y-1);I=0}var R,b=0;for(p=0;p<h.length;p++){R=h[p];var N=d[c+parseInt(p)-h.length+1].width,G=N-N/n*I,L=Math.round(d[c+parseInt(p)-h.length+1].height*(G/N));b+1-G%1>=.5?(b-=G%1,G=Math.floor(G)):(b+=1-G%1,G=Math.ceil(G)),R.style.cssText="width: "+G+"px;height: "+L+"px;margin-right: "+(p<h.length-1?A:0)+"px",0===p&&(R.className+=" "+a.firstItemClass),p==h.length-1&&(R.className+=" "+a.lastItemClass)}h=[],n=0}}}t.fn.rowGrid=function(a){return this.each(function(){var s=t(this);if("appended"===a){a=s.data("grid-options");var i=s.children("."+a.lastRowClass),r=i.nextAll(a.itemSelector).add(i);e(this,a,r)}else a=t.extend({},t.fn.rowGrid.defaults,a),s.data("grid-options",a),e(this,a),a.resize&&t(window).on("resize.rowGrid",{container:this},function(t){e(t.data.container,a)})})},t.fn.rowGrid.defaults={minMargin:null,maxMargin:null,resize:!0,lastRowClass:"last-row",firstItemClass:null,lastItemClass:null}}(jQuery);